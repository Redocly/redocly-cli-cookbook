# Require Bash Sample

Authors:
- [@hawkeyexl](https://github.com/hawkeyexl) Manny Silva ([Doc Detective](https://doc-detective.com))

## What this does and why

This rule makes sure that each `x-code-samples` array has at least one sample where `lang` is `bash`. This is useful for API documentation where you want to make sure that you have a `bash` sample for each operation.

## Code

### Redocly config - `redocly.yaml`

Update your Redocly configuration file to include the plugin and rule. Update paths as necessary.

```yaml
plugins:
  - './require-bash-plugin.js'

rules:
  openapi-bash-sample/require-bash-sample: error
```

### Plugin - `require-bash-plugin.js`

The plugin defines the rule and returns it. Update paths as necessary.

```js 
const RequireBashSample = require('./require-bash-sample');

module.exports = function myRulesPlugin() {
  return {
    id: 'openapi-bash-sample',
    rules: {
      oas3: {
        'require-bash-sample': RequireBashSample,
      },
    },
  };
};
```

### Rule - `require-bash-sample.js`

```js
module.exports = RequireBashSample;

function RequireBashSample() {
  return {
    XCodeSampleList: {
      enter(codeSampleList, ctx) {
        // Make sure the list contains at least one bash sample
        const hasBashSample = codeSampleList.some((codeSample) => {
          return codeSample.lang === "bash";
        });
        if (!hasBashSample) {
          ctx.report({
            message: `The code sample list must contain at least one bash code sample.`,
          });
        }
      },
    },
  };
}
```

## Examples

Given an OpenAPI description with the followig `x-code-samples` array:

```yaml
x-code-samples:
  - lang: python
    source: example.py
  - lang: javascript
    source: example.js
```

You get the following output:

```text
"The code sample list must contain at least one bash code sample."

50 | x-code-samples:
51 |   - lang: python
52 |     source: example.py
53 |   - lang: javascript
54 |     source: example.js

Error was generated by the openapi-bash-sample/require-bash-sample rule.
```